package tls

import (
	"testing"

	"github.com/stretchr/testify/assert"
	"github.com/vipulvpatil/candidate-tracker-go/internal/config"
)

func Test_LoadTLSCredentials(t *testing.T) {
	cfg := config.Config{
		CaCertBase64:     "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUU3akNDQXRhZ0F3SUJBZ0lCQVRBTkJna3Foa2lHOXcwQkFRc0ZBREFYTVJVd0V3WURWUVFERXd4VGIyTnAKWVd4TmFXNWxRMEV3SGhjTk1qTXdNVEEwTVRneE5ESTJXaGNOTWpRd056QTBNVGd5TkRJMVdqQVhNUlV3RXdZRApWUVFERXd4VGIyTnBZV3hOYVc1bFEwRXdnZ0lpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElDRHdBd2dnSUtBb0lDCkFRQ2x0ZmxwYXJXd3VuYlpDQlprSy8zVjY4dHg0NDltQ3BIUUZiVjRCYU1JUERTdzJIQVV5T0F1eWtBV29Pa0oKZitaMjh1TDRmeVFQajkrWDVnbHYvaWg0ejRqWU5BbjJ4NTUvbXFXY1pGM01yTmd2ZWpzYjc0d01pVHo2bFJrQgpRSFFsSnJpVlV5RXdKaTNpQU52NXVNNnVrdzArOXowOEhuWnpteFpsSXg3RzJlZmk3bFR6cklDU0ZCazJSZ05aClAvakdUUTUvc3pLT0RuMGkwTXI0K0duZTFRb3dpeG9WRVQ3Y0lTcEtKOHpkWk9MeHRPM2I5bUNTNzJLaCtRYVgKbkZzWjVwNWxBUmdSeEpJd2pBZkQ1ejFUVkRTVXFFcjliMEhvZGVEdTZ4R2VaTG1wdFVPTU45eFBLNysxeFpwTgorZFpLcEV0TmFJS2NJNnBYTlFoOGh5OEs0dXl5S0g2UGpZbWNpQlZXdmFORkt1SGVxUWVScEJWTXB0TlJQa3lJCmxLRGkxN0N4MGpaRmlqRVpPeVd1R1d1TDVBMUN1ZTBNMjVkczlYZWE5b3F6dy9mOFFONDBGQzF6UFVzMXAxc1YKTlgzNitFOVlOeGtUMnNPa09kaWtlU2hWbTJQaGRaWWNMd3hRMTdLdCs3WDZpOUo5MVZuYm5ja0xGTGsxc0d5cApkYithaEowYW4wZitFa2dVOHpmS3JrUkdQYmp3YjJOZmpzY0hSUXhXMXBtczNpTGMxazNsY1U3NXRyZ1k4RlRVCnNVbm9henZvQWFQOEJLNnRoYXRUSEoxdFJadXQxVFZleWxKUkdVSnFZQkNHR0dnTVMwRmREVVZUZGh5SGlhbGEKd2h5dHgvRjVRL0pJN3FGTDJjczdOcmtLUTlMWHphVHJJeWpxWkoybDRGQjN3UUlEQVFBQm8wVXdRekFPQmdOVgpIUThCQWY4RUJBTUNBUVl3RWdZRFZSMFRBUUgvQkFnd0JnRUIvd0lCQURBZEJnTlZIUTRFRmdRVSswYVZ4bmE2ClloVXZPVDNuYVJidHRLbE0xWkl3RFFZSktvWklodmNOQVFFTEJRQURnZ0lCQUU0OFdVSnNXd3ZTOHowSGtZM3IKU3lqSHQ4djhqNHFseUlrdjJkTnNNdythZWRVZ3dyUnVPMmQrRzRIZmxnc3dBT25aMktrOGExYWV4N0Z2QXhUTApHaDNZa0k0MmFkZkNGVFlsbHdUMVE3RHpPTVFxcGZOS2htdVJWU0cxRU1SNzlEK1hwbjRxK05JS0UvbjJVTnI2CmdTT2k2SjF1WXpkUWRpK1FMdTN4NnJTVmhDclJUbjhKMkxiK0xwVWZkREdDeUdpckJXeGtQeEtVYmcvUmhDREYKMlNUL1hGZ2VZbzZoZWdGRXExMWRpSHd3LzlvblpOejJaS2lTTXdUY21zcDVlR09iM2pDUVV2cnNFU29WdEZpUwp2YnNOV2R6WWs5VVJqclVGMTlQS3N4SmRsejV2d2RNcTBZc2IxemJDTXAvUTlqTGVJUUt6NExzUXA3WFdmS1VHCk1QdlJHbnVqcVprT29GWWsvbU53R1A3VU5MakhhYlNkUW05MThGeTVYaGtJTEpqSmJjdHU4NjJHRXVMWXNTVHMKam4vMm80Q3hKS0psdys4a3FENFhNSFppcUVKYkRuTzMvSzI3K0ZaSDZ5YU1reXRtQkhCQlZEbjBxK2tubG0waQpsZ0pDaWc2ODEzTkdDQU1sL2hiWWk4cEhFd2FBb00vSVhwTUVTcGNrMjk4TlNmOGd0NmNGRy8zTCtCWHNFTzVUCnBvdm1SbTJwaCtjQkUrWFZsK3RqeDZhcUdnN1lqbW1nc20wc1l2ODVpeTFCbXFUSVFFbVVwYlQyVUlWMkI4SEIKZ0NUVEdKMlEzWnk3dVVSbmwxZk03cnNVRkhab3BmUU0wQS8yU1I5S1pOVHpDdEQyN1hHSXZKRm5aRGlvMzlMbQplNFZSS1V0SGFvcGxjc2oyNVp3NlpOVmYKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=",
		ServerCertBase64: "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVTakNDQWpLZ0F3SUJBZ0lRSUR3QTlQOUhqZ3R6Uk9kRkI0UWF5akFOQmdrcWhraUc5dzBCQVFzRkFEQVgKTVJVd0V3WURWUVFERXd4VGIyTnBZV3hOYVc1bFEwRXdIaGNOTWpNd01UQTBNVGd4TkRJMldoY05NalF3TnpBMApNVGd5TkRJMVdqQVhNUlV3RXdZRFZRUURFd3h6YjJOcFlXeHRhVzVsWjI4d2dnRWlNQTBHQ1NxR1NJYjNEUUVCCkFRVUFBNElCRHdBd2dnRUtBb0lCQVFEQkNickMrc3FibjFMNkFpdXFGamQ3NlBIR0lUc1JNcmtFRjZKZHhLSlAKanhkSktZM3EvL1R6VGpUMm1LNGkzbXRneDZMbWR4SklpSS9Bb1ZLMHJWVmF4RGVCbFQrU0t6dkhnUE5NZXpycgpzTGN1TUR4cTk1VytlNVA4aEVLb3FJSVp3ZzU1bExIR3RhNXplSlluMGdmaGNWRzAzRDZHaXovejhVcXRkbSs3CnNObVdZbTlqWXR3SDRHZkZ5N1FBdlp4Tk1GQlI1MzFmS0xwTHg2U0NsNjd6Q0ZCOE1YWWU2Zm5MZnZ4ME5tRDcKQUJ6Z3lLbFV5U0lMUUkvTXZOd3hhWXFuaW1Sek9zVG13cFU3NnBPaFNEU3RKWTZCTVpCb0dWWGdESDFEV2JTSwpPbXZ3QXNlZFBNMEpyREd3RUZNU083VnlQZ3F1RlFvdGNrc2JqUnpNSHpDMUFnTUJBQUdqZ1pFd2dZNHdEZ1lEClZSMFBBUUgvQkFRREFnTzRNQjBHQTFVZEpRUVdNQlFHQ0NzR0FRVUZCd01CQmdnckJnRUZCUWNEQWpBZEJnTlYKSFE0RUZnUVVlVE9odllBVU15VHFSLzZrSGhwVC83Ti9lMDB3SHdZRFZSMGpCQmd3Rm9BVSswYVZ4bmE2WWhVdgpPVDNuYVJidHRLbE0xWkl3SFFZRFZSMFJCQll3RklJTWMyOWphV0ZzYldsdVpXZHZod1JBNFZsTk1BMEdDU3FHClNJYjNEUUVCQ3dVQUE0SUNBUUJHcWN3UlFlc2xJbjVIa0tZY0pQcjloYXBoZU8vZkxwSUN6YWFVc3g4Qm5aTE8KNlBZb3l3eUQvNFJPWmpJL2JENnBnRndsV3lIUU9PVHJkdTJ0d1k2ekFvM1BPRCtIREtTNy80MUhiNXo2NnNJdApVOFhWTEZGVm5HTENBZ3p2S3dhL2RNMC8xaWhja0svR1hQMkM0Vm03eWQvYXdvUXYrWjhSbnEwcmgveHFna1BKCnJ2aVFhNWFSbTZhZStSckltZTVVeUhzSDg4RjFjWld6N3hQc1lMc1pDdFRsbFE5MjA4N2F0enpUYTBHRk1OY0MKTjJjd0lqRTFsOThFaW81TktzU0dZVVBMdWtWeXpkT1I1WFdja0kzeFNHdTZyYWJXcjcvYlBxQ2tMNE1sL2dUbgppTnM1LzhHZm1vMlJCMnYxTk5OSkxDWlhpYi9pSkd3aW1iK3J3b1Iwc0pkQlVNM0xnWFRka3JBbnBZem01STV0CnFxd3VCMWQ3eURFRC9jb2tVNTBQRzhJRDVuRWVmTmp1NytacjB4ak1YUjZtV2g4REh4VmlxUnlrbXJ6cWRNM0EKaTRsUjlpUU1Cc1ZmUXEraTRBb3U5RFQ4MDFxd2JlQ2ZWVDRydUlJbXlEdlFkL1EwWkl5MzRzcUR6WFdTb3VGUApZNktlR0VObm1Rd3ZYQ2N3Z3dHZ21KaWhBU2I2anpyS0J4ZEFuVzJ0bklvdG9TTG1MUEcwd21QN3lsLzUvd2pKCkh3RlB5NWdSV1JFSGtDMHZkMlV3d0NUZTRjc3pYNjk5RnhtcHBIdnFvUzdPMWxIZmdPL0lwZjRHaldQK3ZVRmEKMXFEd2tlcisrbXFIZURxZ2tqeEVINGF2WjFrbXhnV0ZLYXlEV3I2ZklXY1cxWFdwdXYvN3hGTm16VFJuRlE9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==",
		ServerKeyBase64:  "LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb2dJQkFBS0NBUUVBd1FtNnd2ckttNTlTK2dJcnFoWTNlK2p4eGlFN0VUSzVCQmVpWGNTaVQ0OFhTU21OCjZ2LzA4MDQwOXBpdUl0NXJZTWVpNW5jU1NJaVB3S0ZTdEsxVldzUTNnWlUva2lzN3g0RHpUSHM2NjdDM0xqQTgKYXZlVnZudVQvSVJDcUtpQ0djSU9lWlN4eHJXdWMzaVdKOUlINFhGUnROdytob3MvOC9GS3JYWnZ1N0RabG1KdgpZMkxjQitCbnhjdTBBTDJjVFRCUVVlZDlYeWk2Uzhla2dwZXU4d2hRZkRGMkh1bjV5Mzc4ZERaZyt3QWM0TWlwClZNa2lDMENQekx6Y01XbUtwNHBrY3pyRTVzS1ZPK3FUb1VnMHJTV09nVEdRYUJsVjRBeDlRMW0waWpwcjhBTEgKblR6TkNhd3hzQkJURWp1MWNqNEtyaFVLTFhKTEc0MGN6Qjh3dFFJREFRQUJBb0lCQUhYNDhENkE3cG0xQVF6eApqcVhmOWdDd0dESXgxTnRwMkZCNzhTckZKVHppQWlVZ1ZDOHVSaEQ3MXJwdURONGFlQjBwWkpEY2JEd1AyV3FzCkxOTm1xeWRSaTJxU1A4dWd5R1BnbHRCQzczdGpBRkFtQW9hTTBPTWN1eEF6OUZrR3dwdmpVTjFVMW1ET1g5TUoKK3hwUzdhWUZqeDJ0RERsRm1Nd0l4czdEOXYwSXcvZmxhRUtFMFBRNjZ0OUxUMDNpcmF3SlBoZWlOVVkvZjVhQQpyZVh5MkF3OWo2UmlpbVVwRTdvbWJYNm5FZmo4NDVUMXRRVmtMSmxIdldrNGJvb3h3OVlCaVo4a0xoRkN4TFRWCk1PdlY5VHdQOTZKZkJONGVaU0d3VFFsOHFMZXUrbDk1eXR0alpXRTByVlI5bTNtUCs2RGthb1NsNlJhZEExRU4KUVpVQVlIRUNnWUVBM0luRmZKV1JUV3ZFN2crN3Eyd04rMi9TS21aamVlOUlRczhLRW51Qnp4RUJveDRLZjdONgo4U0t0cjIxdVRQZGtjd0pCNktXWm1iaFoySTFtaFFlQUxxWU5JMDU2MUdiZGlBRWRGWittaTVNZGNVVmxDblpaCnFRR1Q3WVg5REJnZXVBSjBiV0dqT2RXVU51ZnArMXQrWjVlTnpoNUpGNmsrOFl5d21BdVJUUU1DZ1lFQTRCUHgKSTRqaU90ODRqUExseDlhUEZhLytZeEh3eTFDbnBVcEZIM0k3STF3Rk9IMWE4cFlvdnNBNUZDSXZmZUs4aWV5dQpuOGtnMkM5akI1K0lnUVo1WFM3d0xmQkdkc3JtKzNBU1c1ek5wM1BYRGJNYUg0ckx6SGdSSUdLUVEyRE5MSlpmClVmNG1DSzNOeTFLTXFUblphNEdQK1o4QmswYmd5RXpSbkR2TWtlY0NnWUFrK2NSdXV2VDlzZy8yaWhUQkRRRGIKSTBodGEzVktRR0F4TTExUTgvd3pwM3BLeXdLZm5vd0NXZm9jNjVBT3YzdkwvSmpvVkx1SUZteVo3anMrR3AvWApNbWdKZjJNQXNhNTYyeFR4Unk4NVA1VTBKSnBvUXFlTnVvSCsxUFEwVHViM214SENOUmlVM2NaWDNsSlFubXAzCkcrWGVwUjFFSmxBelY0OVVMcnhSMlFLQmdEaGFpNUNtUWs4UUNJYmFKNVBFa0NPaUtWWDlFeFB1NnRxVS9TRlYKZHk0RFhJVENjZmNFY0tiWWJRSjFQb0JvWDRaSWNmcFplTnNsdjhBUkRTRjE0VnZnRENOaGhEY24vRU5NQWpIcwpFNFNEaTVnMGJPTjE0cDgvcXY3OEN0QUhMbEtDVnVLbUNpYXduMHI5TGNiNWQ0YWtCUE9BVzhNUVZrUEpuZ1d1CnZGb05Bb0dBQmJmSTd5dCs0WlpzcUpKaTh6Skd4b0Q1dkF3RjNudjd6d0pVbC8vcVQ1MGQ0QUZoeUd6WXNqUGMKRG0xMlRDUmNRbFBvU2VrZG9ZQlcxd296WDY2Q3BpMTZzYVNmVFJ5WDE1N0VsSS9WbEpGYWdSb3RUYXJacWpHbwptSk5rMU1YdmVvTWNZZ2tIRFRKNDRzSi9Xc3REQVBhNWZwRDlCY2ppcGlFY3NCWWdkNjQ9Ci0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==",
	}
	t.Run("TLS credentials can be initialized correctly", func(t *testing.T) {
		cred, err := LoadTLSCredentials(&cfg)
		assert.NoError(t, err)
		assert.NotNil(t, cred)
	})
}
